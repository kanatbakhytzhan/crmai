# üîß –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ - –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

Internal Server Error (500) –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ª—é–±–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (–ó–∞—è–≤–∫–∏, –ö–ª–∏–µ–Ω—Ç—ã, –ö–æ–º–ø–∞–Ω–∏–∏).

---

## ‚úÖ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û:

### 1. –ü—Ä–æ–≤–µ—Ä–µ–Ω AsyncEngine
- ‚úÖ SQLAdmin –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç AsyncEngine>=0.16.0
- ‚úÖ Engine –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –°–æ–∑–¥–∞–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π sync_engine –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 2. –£–ø—Ä–æ—â–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ModelView
- ‚úÖ –£–±—Ä–∞–Ω—ã –≤—Å–µ `column_searchable_list` (–º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏)
- ‚úÖ –£–±—Ä–∞–Ω—ã –≤—Å–µ `column_filters` (—Å—Ç—Ä–æ–∫–∏ –≤–º–µ—Å—Ç–æ –æ–±—ä–µ–∫—Ç–æ–≤ Filter)
- ‚úÖ –£–±—Ä–∞–Ω—ã –≤—Å–µ `column_formatters` (—Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å Enum)
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: —Ç–æ–ª—å–∫–æ `column_list` –∏ `form_columns`

### 3. –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –õ–æ–≥–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∫–∏
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∏–ø–µ engine

---

## üîç –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| –õ–æ–≥–∏–Ω | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Dashboard | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ó–∞—è–≤–∫–∏ (list) | ‚ùå 500 Error |
| –ö–ª–∏–µ–Ω—Ç—ã (list) | ‚ùå 500 Error |
| –ö–æ–º–ø–∞–Ω–∏–∏ (list) | ‚ùå 500 Error |

---

## üöÄ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–û–ï –†–ï–®–ï–ù–ò–ï:

### –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è —Ç–æ—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä** (Chrome/Firefox)

2. **–û—Ç–∫—Ä–æ–π—Ç–µ DevTools** (F12)

3. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É Console**

4. **–û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É:**
   ```
   http://localhost:8000/admin
   ```

5. **–í–æ–π–¥–∏—Ç–µ:** admin / admin123

6. **–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ "–ó–∞—è–≤–∫–∏"**

7. **–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫—É –≤ Console**

–í—ã —É–≤–∏–¥–∏—Ç–µ —Ç–æ—á–Ω—É—é JavaScript –æ—à–∏–±–∫—É –∏–ª–∏ –¥–µ—Ç–∞–ª–∏ 500 –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É.

---

## üõ†Ô∏è –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï –†–ï–®–ï–ù–ò–Ø:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –≤–º–µ—Å—Ç–æ –∞–¥–º–∏–Ω–∫–∏

–ü–æ–∫–∞ –∞–¥–º–∏–Ω–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ API endpoints:

**–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞—è–≤–∫–∏:**
```bash
# 1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
curl -X POST http://localhost:8000/api/auth/login \
  -d "username=test@company.kz" \
  -d "password=test123"

# 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω
curl -H "Authorization: Bearer YOUR_TOKEN" \
     http://localhost:8000/api/leads
```

**–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å:**
```bash
curl -X PATCH \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"status": "in_progress"}' \
  http://localhost:8000/api/leads/1
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –∞–¥–º–∏–Ω–∫—É

**FastAPI Admin:**
```bash
pip install fastapi-admin
```

**Piccolo Admin:**
```bash
pip install piccolo-admin
```

---

## üîß –ë–´–°–¢–†–´–ô –§–ò –ö–° (–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ relationships):

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ SQLAdmin –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å relationships, –∏–∑–º–µ–Ω–∏—Ç–µ –º–æ–¥–µ–ª–∏:

### –í `app/database/models.py`:

**–î–û:**
```python
class Lead(Base):
    owner_id = Column(Integer, ForeignKey("users.id"))
    bot_user_id = Column(Integer, ForeignKey("bot_users.id"))
    
    owner = relationship("User", back_populates="leads")
    bot_user = relationship("BotUser", back_populates="leads")
```

**–ü–û–°–õ–ï:**
```python
class Lead(Base):
    owner_id = Column(Integer, ForeignKey("users.id"))
    bot_user_id = Column(Integer, ForeignKey("bot_users.id"))
    
    # –û–¢–ö–õ–Æ–ß–ê–ï–ú relationships –¥–ª—è SQLAdmin
    # owner = relationship("User", back_populates="leads", lazy="noload")
    # bot_user = relationship("BotUser", back_populates="leads", lazy="noload")
```

---

## üìä –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨ –í –ë–†–ê–£–ó–ï–†–ï:

### Network Tab (F12 ‚Üí Network):

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/lead/list`
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ HTTP –∑–∞–ø—Ä–æ—Å
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Response (Preview/Response tabs)

**–û–∂–∏–¥–∞–µ–º—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

- **500 —Å JSON**: –¢–æ—á–Ω–∞—è –æ—à–∏–±–∫–∞ –±—É–¥–µ—Ç –≤ JSON
- **500 —Å HTML**: –û—à–∏–±–∫–∞ –≤ —Ç–µ–∫—Å—Ç–µ HTML
- **Empty response**: –¢–∞–π–º–∞—É—Ç –∏–ª–∏ crash

### Console Tab:

**JavaScript –æ—à–∏–±–∫–∏:**
- TypeError
- SyntaxError
- Network Error

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ** ‚Üí –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–æ—á–Ω—É—é –æ—à–∏–±–∫—É
2. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å relationships** ‚Üí –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏—Ö
3. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å Enum** ‚Üí –ò–∑–º–µ–Ω–∏—Ç–µ `status` –Ω–∞ String
4. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å SQLAdmin** ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É

---

## üìù –í–†–ï–ú–ï–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï:

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/docs` (Swagger UI) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

```
http://localhost:8000/docs
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `POST /api/auth/login` - –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
- `GET /api/leads` - –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫
- `GET /api/leads/{id}` - –û–¥–Ω–∞ –∑–∞—è–≤–∫–∞
- `PATCH /api/leads/{id}` - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
- `DELETE /api/leads/{id}` - –£–¥–∞–ª–∏—Ç—å

---

## üîç –û–¢–õ–ê–î–û–ß–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

**`app/admin.py`:**
```python
class LeadAdmin(ModelView, model=Lead):
    name = "–ó–∞—è–≤–∫–∞"
    name_plural = "–ó–∞—è–≤–∫–∏"
    
    column_list = [Lead.id, Lead.name, Lead.phone, Lead.city]
    form_columns = [Lead.name, Lead.phone, Lead.city]
    
    can_create = False
    can_edit = True
    can_delete = True
    can_view_details = False
```

**Engine:**
- AsyncEngine: –¥–ª—è FastAPI (–æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
- SyncEngine: –¥–ª—è SQLAdmin (–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)

---

## ‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:

**–û–¢–ö–†–û–ô–¢–ï –ê–î–ú–ò–ù–ö–£ –í –ë–†–ê–£–ó–ï–†–ï –° DEVTOOLS!**

–≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —É–≤–∏–¥–µ—Ç—å —Ç–æ—á–Ω—É—é –æ—à–∏–±–∫—É, —Ç–∞–∫ –∫–∞–∫ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–µ—Ç–∞–ª–µ–π.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫—É –∏–∑ Console
2. –ü—Ä–∏—à–ª–∏—Ç–µ –º–Ω–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
3. –Ø –ø—Ä–µ–¥–ª–æ–∂—É —Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

---

**–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ API endpoints —á–µ—Ä–µ–∑ Swagger UI (`/docs`) - –æ–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã!
